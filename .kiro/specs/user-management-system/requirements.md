# 需求文档

## 介绍

用户管理系统是一个基于spring boot 2.7.x,Java 8后端和Vue 2前端的Web应用程序，用于管理用户账户、角色和权限。系统使用Maven作为构建工具，MyBatis-Plus作为ORM框架，PostgreSQL作为数据库。该系统提供完整的用户生命周期管理功能，包括用户注册、登录、信息管理和权限控制。
前后端放在不同的目录中,前端直接调用后端不需要通过nginx

## 需求

### 需求 1 - 用户注册

**用户故事：** 作为一个新用户，我希望能够注册账户，以便我可以访问系统功能。

#### 验收标准

1. 当用户提供有效的用户名、邮箱和密码时，系统应该创建新的用户账户
2. 当用户名已存在时，系统应该返回错误信息"用户名已存在"
3. 当邮箱已存在时，系统应该返回错误信息"邮箱已被注册"
4. 当密码长度少于8位时，系统应该返回错误信息"密码长度至少8位"
5. 当邮箱格式无效时，系统应该返回错误信息"邮箱格式无效"
6. 当注册成功时，系统应该返回成功信息并自动为用户分配默认角色

### 需求 2 - 用户登录

**用户故事：** 作为一个已注册用户，我希望能够登录系统，以便我可以访问我的账户和相关功能。

#### 验收标准

1. 当用户提供正确的用户名和密码时，系统应该允许用户登录并生成JWT令牌
2. 当用户名不存在时，系统应该返回错误信息"用户名或密码错误"
3. 当密码错误时，系统应该返回错误信息"用户名或密码错误"
4. 当用户账户被禁用时，系统应该返回错误信息"账户已被禁用"
5. 当登录成功时，系统应该记录用户最后登录时间
6. 当JWT令牌过期时，系统应该要求用户重新登录

### 需求 3 - 用户信息管理

**用户故事：** 作为一个已登录用户，我希望能够查看和更新我的个人信息，以便保持信息的准确性。

#### 验收标准

1. 当用户请求查看个人信息时，系统应该显示用户的基本信息（用户名、邮箱、创建时间、最后登录时间）
2. 当用户更新个人信息时，系统应该验证新信息的有效性
3. 当用户更改邮箱时，系统应该验证新邮箱未被其他用户使用
4. 当用户更改密码时，系统应该要求输入当前密码进行验证
5. 当信息更新成功时，系统应该返回成功信息并更新数据库记录
6. 当用户没有权限修改某些字段时，系统应该返回权限错误

### 需求 4 - 用户列表管理

**用户故事：** 作为管理员，我希望能够查看和管理所有用户，以便进行用户管理操作。

#### 验收标准

1. 当管理员请求用户列表时，系统应该返回分页的用户列表
2. 当管理员搜索用户时，系统应该支持按用户名、邮箱进行模糊搜索
3. 当管理员筛选用户时，系统应该支持按状态（启用/禁用）和角色进行筛选
4. 当管理员查看用户详情时，系统应该显示完整的用户信息
5. 当非管理员用户尝试访问用户列表时，系统应该返回权限错误
6. 当用户列表为空时，系统应该显示相应的提示信息

### 需求 5 - 用户状态管理

**用户故事：** 作为管理员，我希望能够启用或禁用用户账户，以便控制用户对系统的访问。

#### 验收标准

1. 当管理员禁用用户时，系统应该将用户状态设置为禁用并阻止该用户登录
2. 当管理员启用用户时，系统应该将用户状态设置为启用并允许该用户正常登录
3. 当管理员尝试禁用自己的账户时，系统应该返回错误信息"不能禁用自己的账户"
4. 当状态更改成功时，系统应该记录操作日志
5. 当非管理员用户尝试更改用户状态时，系统应该返回权限错误
6. 当被禁用的用户尝试登录时，系统应该返回账户禁用错误

### 需求 6 - 角色权限管理

**用户故事：** 作为管理员，我希望能够管理用户角色和权限，以便控制不同用户的系统访问级别。

#### 验收标准

1. 当管理员为用户分配角色时，系统应该更新用户的角色信息
2. 当管理员创建新角色时，系统应该允许定义角色名称和权限
3. 当角色名称已存在时，系统应该返回错误信息"角色名称已存在"
4. 当管理员删除角色时，系统应该检查是否有用户正在使用该角色
5. 当有用户使用某角色时，系统应该阻止删除该角色并返回相应错误信息
6. 当权限验证失败时，系统应该返回403权限错误

### 需求 7 - 数据持久化

**用户故事：** 作为系统，我需要可靠地存储和检索用户数据，以便保证数据的完整性和一致性。

#### 验收标准

1. 当系统启动时，应该自动创建必要的数据库表结构
2. 当执行数据库操作时，系统应该使用事务确保数据一致性
3. 当数据库连接失败时，系统应该返回相应的错误信息
4. 当执行SQL查询时，系统应该使用MyBatis-Plus进行ORM映射
5. 当数据验证失败时，系统应该回滚事务并返回错误信息
6. 当系统关闭时，应该正确关闭数据库连接池

### 需求 8 - 前端界面

**用户故事：** 作为用户，我希望有一个直观易用的Web界面，以便方便地使用系统功能。

#### 验收标准

1. 当用户访问系统时，应该显示响应式的登录界面
2. 当用户登录成功时，应该显示主导航菜单和用户信息
3. 当用户进行操作时，应该显示适当的加载状态和反馈信息
4. 当发生错误时，应该显示用户友好的错误提示
5. 当用户权限不足时，应该隐藏或禁用相关功能按钮
6. 当数据加载时，应该显示分页控件和搜索功能