# 实施计划

## 后端实施任务

### 1. 项目基础设置

- [ ] 1.1 创建Spring Boot项目结构和基础配置
  - 创建Maven项目结构，配置pom.xml依赖
  - 设置Spring Boot 2.7.x、MyBatis-Plus、PostgreSQL驱动等依赖
  - 创建application.yml配置文件
  - _需求: 7.1, 7.4_

- [ ] 1.2 配置数据库连接和MyBatis-Plus
  - 配置PostgreSQL数据库连接参数
  - 设置MyBatis-Plus配置类和代码生成器配置
  - 创建数据库初始化脚本
  - _需求: 7.1, 7.2, 7.4_

- [ ] 1.3 设置Spring Security和JWT配置
  - 创建SecurityConfig配置类
  - 实现JWT令牌提供者和认证过滤器
  - 配置CORS支持前后端分离
  - _需求: 2.1, 2.6, 6.6_

### 2. 数据层实施

- [ ] 2.1 创建数据库表结构
  - 创建users、roles、user_roles表的SQL脚本
  - 实现数据库表自动创建和初始化
  - 插入默认角色数据(ADMIN, USER)
  - _需求: 7.1, 6.2_

- [ ] 2.2 实现实体类和数据传输对象
  - 创建User、Role、UserRole实体类
  - 实现LoginRequest、RegisterRequest、UserResponse等DTO类
  - 添加数据验证注解和MyBatis-Plus注解
  - _需求: 1.1-1.6, 2.1-2.6, 3.1-3.6_

- [ ] 2.3 实现数据访问层
  - 创建UserMapper和RoleMapper接口
  - 实现用户查询、分页、搜索和筛选方法
  - 实现角色管理相关的数据访问方法
  - _需求: 4.1-4.3, 6.1, 6.4-6.5_

### 3. 业务逻辑层实施

- [ ] 3.1 实现用户认证服务
  - 创建AuthService实现用户登录验证逻辑
  - 实现JWT令牌生成和验证功能
  - 处理登录错误情况和账户状态检查
  - _需求: 2.1-2.6_

- [ ] 3.2 实现用户注册服务
  - 创建用户注册业务逻辑
  - 实现用户名和邮箱唯一性验证
  - 实现密码加密和默认角色分配
  - _需求: 1.1-1.6_

- [ ] 3.3 实现用户信息管理服务
  - 创建UserService实现个人信息查看和更新
  - 实现密码修改功能，包含当前密码验证
  - 实现邮箱更改时的唯一性检查
  - _需求: 3.1-3.6_

- [ ] 3.4 实现用户列表管理服务
  - 实现分页用户列表查询功能
  - 实现按用户名、邮箱的模糊搜索
  - 实现按状态和角色的筛选功能
  - _需求: 4.1-4.6_

- [ ] 3.5 实现用户状态管理服务
  - 实现用户启用/禁用功能
  - 添加管理员不能禁用自己账户的限制
  - 实现状态变更的操作日志记录
  - _需求: 5.1-5.6_

- [ ] 3.6 实现角色权限管理服务
  - 创建RoleService实现角色CRUD操作
  - 实现用户角色分配功能
  - 实现角色删除前的使用检查
  - _需求: 6.1-6.6_

### 4. 控制器层实施

- [ ] 4.1 实现认证控制器
  - 创建AuthController处理登录、注册、登出请求
  - 实现JWT令牌刷新接口
  - 添加请求参数验证和错误处理
  - _需求: 1.1-1.6, 2.1-2.6_

- [ ] 4.2 实现用户管理控制器
  - 创建UserController处理用户CRUD操作
  - 实现用户列表查询接口，支持分页和搜索
  - 实现用户状态管理接口
  - _需求: 3.1-3.6, 4.1-4.6, 5.1-5.6_

- [ ] 4.3 实现角色管理控制器
  - 创建RoleController处理角色管理操作
  - 实现用户角色分配接口
  - 添加权限控制确保只有管理员可访问
  - _需求: 6.1-6.6_

### 5. 异常处理和安全

- [ ] 5.1 实现全局异常处理
  - 创建GlobalExceptionHandler处理业务异常
  - 定义错误码枚举和统一错误响应格式
  - 实现参数验证异常和权限异常处理
  - _需求: 1.2-1.5, 2.2-2.4, 5.3, 6.6_

- [ ] 5.2 实现JWT安全认证
  - 创建JwtAuthenticationFilter拦截请求
  - 实现UserDetailsServiceImpl加载用户详情
  - 配置受保护的API端点和权限要求
  - _需求: 2.1, 2.6, 6.6_

- [ ] 5.3 实现密码安全和验证
  - 使用BCrypt实现密码加密
  - 实现密码强度验证规则
  - 添加登录失败处理机制
  - _需求: 1.4, 2.3, 3.4_

## 前端实施任务

### 6. 前端项目基础设置

- [ ] 6.1 创建Vue 2项目结构
  - 初始化Vue 2项目，配置webpack和依赖
  - 安装Element UI、Vue Router、Vuex、Axios等依赖
  - 创建项目目录结构和基础配置文件
  - _需求: 8.1-8.6_

- [ ] 6.2 配置路由和状态管理
  - 设置Vue Router路由配置，包含路由守卫
  - 创建Vuex store模块(auth, user)
  - 配置Axios请求拦截器和响应处理
  - _需求: 8.2, 8.3_

- [ ] 6.3 实现通用组件和布局
  - 创建Layout、Header、Sidebar等布局组件
  - 实现响应式设计和导航菜单
  - 创建通用的加载状态和错误提示组件
  - _需求: 8.1, 8.2, 8.3_

### 7. 认证相关页面

- [ ] 7.1 实现登录页面
  - 创建Login.vue组件，包含表单验证
  - 实现登录API调用和JWT令牌存储
  - 添加登录状态处理和错误提示
  - _需求: 2.1-2.6, 8.1, 8.4_

- [ ] 7.2 实现用户注册页面
  - 创建Register.vue组件，包含实时表单验证
  - 实现注册API调用和成功后的跳转
  - 添加用户名、邮箱唯一性验证提示
  - _需求: 1.1-1.6, 8.1, 8.4_

- [ ] 7.3 实现认证状态管理
  - 创建auth.js Vuex模块管理登录状态
  - 实现JWT令牌自动刷新机制
  - 添加路由守卫检查用户权限
  - _需求: 2.6, 8.2_

### 8. 用户管理页面

- [ ] 8.1 实现个人资料页面
  - 创建Profile.vue组件显示用户信息
  - 实现个人信息编辑和密码修改功能
  - 添加表单验证和成功提示
  - _需求: 3.1-3.6, 8.3, 8.4_

- [ ] 8.2 实现用户列表页面
  - 创建UserList.vue组件，包含分页表格
  - 实现搜索、筛选和排序功能
  - 添加用户状态管理操作按钮
  - _需求: 4.1-4.6, 5.1-5.6, 8.5, 8.6_

- [ ] 8.3 实现用户详情和编辑
  - 创建用户详情查看和编辑功能
  - 实现管理员权限控制，隐藏普通用户无权操作
  - 添加用户角色分配界面
  - _需求: 4.4, 6.1, 8.5_

### 9. 角色管理页面

- [ ] 9.1 实现角色管理页面
  - 创建RoleManagement.vue组件
  - 实现角色列表显示、创建、编辑、删除功能
  - 添加角色删除前的使用检查提示
  - _需求: 6.1-6.6, 8.5_

- [ ] 9.2 实现权限控制界面
  - 根据用户角色显示/隐藏功能按钮
  - 实现403权限错误的友好提示
  - 添加管理员专用功能的访问控制
  - _需求: 6.6, 8.5_

### 10. API集成和数据管理

- [ ] 10.1 实现API接口封装
  - 创建auth.js、user.js、role.js API模块
  - 实现统一的请求错误处理
  - 添加请求加载状态管理
  - _需求: 8.3, 8.4_

- [ ] 10.2 实现数据状态管理
  - 创建user.js Vuex模块管理用户数据
  - 实现数据缓存和自动更新机制
  - 添加分页数据的状态管理
  - _需求: 4.1-4.3, 8.6_

- [ ] 10.3 实现表单验证和工具函数
  - 创建validation.js工具函数
  - 实现统一的表单验证规则
  - 添加日期格式化和数据处理工具
  - _需求: 1.4-1.5, 3.2-3.3, 8.4_

## 集成测试和优化

### 11. 测试实施

- [ ] 11.1 实现后端单元测试
  - 为Service层业务逻辑编写单元测试
  - 为Controller层API接口编写集成测试
  - 使用TestContainers进行数据库集成测试
  - _需求: 7.2, 7.5_

- [ ] 11.2 实现前端单元测试
  - 为Vue组件编写单元测试
  - 为工具函数和API模块编写测试
  - 实现测试覆盖率报告
  - _需求: 8.1-8.6_

- [ ] 11.3 端到端测试
  - 实现用户注册登录流程的端到端测试
  - 测试用户管理和角色管理完整流程
  - 验证权限控制和错误处理
  - _需求: 1.1-6.6_

### 12. 性能优化和部署准备

- [ ] 12.1 数据库优化
  - 为username、email字段添加数据库索引
  - 优化分页查询性能
  - 实现数据库连接池配置
  - _需求: 4.2, 7.6_

- [ ] 12.2 前端性能优化
  - 实现路由懒加载和代码分割
  - 优化大列表的虚拟滚动
  - 添加API响应缓存机制
  - _需求: 8.6_

- [ ] 12.3 部署配置
  - 创建生产环境配置文件
  - 配置前后端的构建和部署脚本
  - 设置环境变量和安全配置
  - _需求: 7.1, 8.1_